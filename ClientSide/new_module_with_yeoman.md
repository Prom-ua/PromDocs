# Создание нового модуля на базе Rx.js + React.js с помощью [Yeoman](http://yeoman.io/)

Данный генератор создаст все необходимые компоненты для нового javascript модуля на базе Rx.js и React.js.
При успешной инициализации мы должны увидеть такое работающее приложение - [demo](http://alexmost.github.io/RxReact/hello_world/public/index.html)
> Подробнее об организации кода в модулях читайте тут - [Архитектура javascript модулей с использованием Rx.js и React.js](https://gist.github.com/AlexMost/46ff7ce23881442294b7)

## Подготовительный этап

### Установка - [Yeoman](http://yeoman.io/)

```bash
npm install -g yo
```
### Установка генератора
Переходим в корень проекта и выполняем команду

```bash
npm install generator-rxreact-module
```
> <b>generator-rxreact-module</b> добавлен в npm зависимости проекта. Если он еще не установлен достаточно выполнить npm install .

Для проверки запускаем yo, и должны увидеть список доступных геренаторов, находим <b>Rxreact Module</b> среди них. Если он есть - значит все установлено правильно:
![YeomanRxReactModule](http://s28.postimg.org/4avv8gwkd/yeomanscreen.png)

## Создание нового модуля
1. [Создание базовой струкруры](#Создание-базовой-струкруры)
2. [Подключение в секцию modules в recipe](#Подключение-в-секцию-modules-в-recipe)
3. [Добавление в соответствующий бандл](#Добавление-в-соответствующий-бандл)
4. [Инициализация через data-extend на странице](#Инициализация-через-data-extend-на-странице)

### Создание базовой струкруры

Для создания базовой структуры модуля перейдем в раздел, в котором хотим его создать и  выполним команду:

```bash
cd uaprom/cs/domain
yo rxreact-module
```

> Вместо <b>yo rxreact-module</b> можно ввести просто <b>yo</b> и выбрать Rxreact Module в списке генераторов.

Yeoman попросит ввести имя нового модуля. По договоренности вводим в CamelCase формате.

В результате мы должны получить такую структуру модуля:

```
.
├── app.coffee
├── dispatcher.coffee
├── index.coffee
├── interface.coffee
├── slug.json
├── storage.coffee
└── view
    └── view.coffee
```
> Подробнее об данной архитектуре - [Архитектура javascript модулей с использованием Rx.js и React.js](https://gist.github.com/AlexMost/46ff7ce23881442294b7)

### Подключение в секцию modules в recipe
Для того чтобы наша билд система(сafe) поняла что есть новый модуль его необходимо включить в секцию <b>modules</b> в <b>recipe_production.yaml</b> файле.

```yaml
modules:
   - ModuleName: ModulePath
```
- ModuleName - имя модуля
- ModulePath - путь к папке с модулем (относительно файла recipe).

### Добавление в соответствующий бандл в recipe
Наш проект логически разбит на admin, cabinet, portal e.t.c приложения(realm в recipe). Каждый realm состоит из 2-x бандлов (core.js, common.js). Это те файлы, которые в результате билда будут загружены в браузер. Добавляем имя нашего модуля в common бандл соответствующего realm-a.

### Инициализация через data-extend в шаблоне
Практика показала, что удобнее всего инициализировать модуль через DNA.

1. Не нужно добавлять лишний javascript для инициализации.
2. Легко перенести модуль на другую страницу.
3. Легко продублировать один и тот же модуль несколько раз на странице.

Для инициализации в шаблонах (mako) необходимо добавить data-extend аттрибут на DOM элемент(mount нода) в который хотим отрисовать наш компонент.

```html
<!-- mount node -->
<div data-extend="ModuleName"></div>
```

Вместо ModuleName подставляем имя нашего модуля.
Если все сделали правильно, в mount ноду должно отрисоваться такое - [demo](http://alexmost.github.io/RxReact/hello_world/public/index.html)